# Gocrete Project Overview

## What is Gocrete?

Gocrete is a **modular Go project scaffolding CLI** that generates backend foundations. It's a code generator, not a framework—it creates projects that become yours to own and modify.

## Philosophy

### Core Principles

1. **Simplicity over over-engineering** - Generate clean, readable code
2. **Explicit over implicit** - Clear dependencies, no hidden magic
3. **Additive modularity** - Add capabilities without breaking existing code
4. **Production-ready defaults** - Real-world configurations that work
5. **No lock-in** - Generated code has no runtime dependency on Gocrete

### What It Is

✅ A starting point for Go projects  
✅ A code generator  
✅ Opinionated about structure  
✅ Modular and extensible  
✅ Production-ready  

### What It Is NOT

❌ A framework  
❌ A runtime dependency  
❌ An ORM or abstraction layer  
❌ Restrictive or prescriptive beyond initial generation  

## Project Structure

```
gocrete/
├── cmd/
│   └── gocrete/              # CLI entry point
│       └── main.go
├── internal/
│   ├── cmd/                  # Cobra commands
│   │   ├── root.go           # Root command
│   │   ├── init.go           # Init command
│   │   └── add.go            # Add command
│   ├── engine/               # Generator engine
│   │   ├── engine.go         # Core generation logic
│   │   └── engine_test.go    # Tests
│   └── modules/              # Module implementations
│       ├── registry.go       # Module registry
│       ├── registry_test.go  # Tests
│       ├── postgres.go       # PostgreSQL module
│       ├── mongo.go          # MongoDB module
│       ├── openapi.go        # OpenAPI modules
│       └── docker.go         # Docker module
├── templates/                # Embedded templates
│   ├── base/                 # Base project (always applied)
│   ├── db/                   # Database templates
│   ├── openapi/              # OpenAPI templates
│   └── docker/               # Docker templates
├── examples/                 # Example use cases
├── docs/                     # Documentation
│   └── ARCHITECTURE.md       # Architecture details
├── go.mod                    # Go module definition
├── go.sum                    # Dependency checksums
├── README.md                 # Main documentation
├── CONTRIBUTING.md           # Contribution guidelines
├── CHANGELOG.md              # Version history
├── LICENSE                   # MIT License
└── Makefile                  # Development tasks
```

## Key Components

### 1. CLI Layer (`internal/cmd/`)

The user interface built with Cobra.

**Commands:**
- `gocrete init` - Initialize new projects
- `gocrete add` - Add modules to existing projects

**Responsibilities:**
- Parse command-line flags
- Validate user input
- Delegate to engine
- Display results

### 2. Generator Engine (`internal/engine/`)

The core orchestration layer.

**Responsibilities:**
- Project directory creation
- Template application
- Module coordination
- Post-generation processing (go mod init, tidy, fmt)

**Key Types:**
```go
type Engine struct {
    registry *modules.Registry
}

type InitOptions struct {
    ProjectName string
    ModulePath  string
    Router      string
    Database    string
    OpenAPI     string
    Docker      bool
    // ...
}
```

### 3. Module System (`internal/modules/`)

Pluggable modules for different capabilities.

**Module Interface:**
```go
type Module interface {
    Name() string
    Apply(ctx *Context) error
}
```

**Available Modules:**
- **PostgreSQL** - pgx connection pool, repositories
- **MongoDB** - mongo-driver client, collections
- **OpenAPI (gen)** - Code generation from specs
- **OpenAPI (manual)** - Manual implementation structure
- **Docker** - Container configuration

### 4. Template System (`templates/`)

Go's embed.FS for bundling templates in the binary.

**Template Rules:**
- Files ending in `.tmpl` are rendered with `text/template`
- Other files are copied as-is
- Templates have access to context data
- Base is always applied first
- Modules are overlays

## Development Workflow

### Building

```bash
# Build binary
make build

# Or manually
go build -o gocrete cmd/gocrete/main.go
```

### Testing

```bash
# Unit tests
make test

# Integration tests
make test-integration

# Coverage
make test-coverage

# Benchmarks
make bench
```

### Development Cycle

```bash
# Format, vet, test, build
make check

# Generate example for testing
make generate-example

# Install locally
make install
```

## Generated Project Structure

Every project generated by Gocrete follows this structure:

```
project-name/
├── cmd/
│   └── server/
│       └── main.go           # Entry point
├── internal/
│   ├── config/               # Configuration
│   │   └── config.go
│   ├── logger/               # Structured logging
│   │   └── logger.go
│   ├── http/                 # HTTP server
│   │   └── server.go
│   ├── errors/               # Error handling
│   │   └── errors.go
│   ├── db/                   # Database (optional)
│   │   ├── postgres/
│   │   └── mongo/
│   └── api/                  # API layer (optional)
│       ├── generated/
│       └── handlers/
├── migrations/               # DB migrations (optional)
├── api/                      # OpenAPI specs (optional)
├── docker-compose.yml        # Docker (optional)
├── Dockerfile                # Docker (optional)
├── Makefile                  # Common tasks (optional)
├── .gitignore
├── .env.example
├── go.mod
└── README.md
```

## Feature Matrix

| Feature | Base | PostgreSQL | MongoDB | OpenAPI | Docker |
|---------|------|------------|---------|---------|--------|
| HTTP Server | ✅ | ✅ | ✅ | ✅ | ✅ |
| Structured Logging | ✅ | ✅ | ✅ | ✅ | ✅ |
| Configuration | ✅ | ✅ | ✅ | ✅ | ✅ |
| Health Checks | ✅ | ✅ | ✅ | ✅ | ✅ |
| Middleware | ✅ | ✅ | ✅ | ✅ | ✅ |
| Database Pool | - | ✅ | ✅ | - | - |
| Repositories | - | ✅ | ✅ | - | - |
| Migrations | - | ✅ | - | - | - |
| API Generation | - | - | - | ✅ | - |
| Containers | - | - | - | - | ✅ |

## Router Options

### Chi (Default)
- **Pros:** Standard library-based, lightweight, excellent middleware
- **Use for:** Most REST APIs, standard web services
- **Community:** Large, mature

### Gin
- **Pros:** Very fast, popular, large ecosystem
- **Use for:** High-performance APIs, existing Gin knowledge
- **Community:** Very large

### Fiber
- **Pros:** Extremely fast, Express-like API
- **Use for:** Maximum performance, microservices
- **Community:** Growing rapidly

## Database Options

### PostgreSQL
- **Driver:** pgx (v5)
- **Features:** Connection pooling, prepared statements, transactions
- **Use for:** Relational data, ACID requirements, complex queries

### MongoDB
- **Driver:** mongo-go-driver (official)
- **Features:** Document model, aggregation pipeline, change streams
- **Use for:** Flexible schemas, high write throughput, document storage

## Use Cases

### 1. REST API
```bash
gocrete init api --module github.com/user/api --db postgres --docker
```

### 2. Microservice
```bash
gocrete init service --module github.com/user/service --router fiber --db mongo
```

### 3. OpenAPI-First
```bash
gocrete init api --module github.com/user/api --openapi gen --spec api.yaml
```

### 4. Minimal Start
```bash
gocrete init app --module github.com/user/app
# Add features later with: gocrete add db --type postgres
```

## Extensibility

### Adding a New Module

1. Create module implementation in `internal/modules/`
2. Register in `internal/modules/registry.go`
3. Create templates in `templates/`
4. Update CLI flags if needed
5. Add tests
6. Update documentation

### Adding a New Router

1. Update `templates/base/internal/http/server.go.tmpl`
2. Add conditional template logic
3. Test generation
4. Update documentation

## Quality Standards

### Code Quality
- Go 1.22+ features
- Standard library preferred
- Clear error messages
- Comprehensive tests
- Documented public APIs

### Generated Code Quality
- Linter-clean (golangci-lint)
- Formatted (gofmt)
- Vetted (go vet)
- Buildable out of the box
- Production-ready defaults

### Documentation
- Clear README in generated projects
- Inline code comments
- Architecture documentation
- Examples for common cases

## Roadmap

### Current (v1.0)
- ✅ Core generator engine
- ✅ Base project template
- ✅ PostgreSQL & MongoDB modules
- ✅ OpenAPI support
- ✅ Docker support
- ✅ Three router options

### Planned (v1.1)
- [ ] gRPC module
- [ ] Redis cache module
- [ ] JWT authentication
- [ ] Metrics (Prometheus)
- [ ] Interactive wizard mode

### Future (v2.0)
- [ ] Plugin system
- [ ] Custom template directories
- [ ] Configuration file support
- [ ] Preset system (microservice, monolith, etc.)
- [ ] Template override mechanism

## Contributing

We welcome contributions! See [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

**Ways to contribute:**
- Report bugs
- Suggest features
- Improve documentation
- Add modules
- Write tests
- Share examples

## Support

- **Documentation:** This repository
- **Issues:** GitHub Issues
- **Discussions:** GitHub Discussions
- **Examples:** `examples/` directory

## License

MIT License - see [LICENSE](LICENSE) file for details.

## Acknowledgments

Built with these excellent tools:
- [Cobra](https://github.com/spf13/cobra) - CLI framework
- [pgx](https://github.com/jackc/pgx) - PostgreSQL driver
- [mongo-go-driver](https://github.com/mongodb/mongo-go-driver) - MongoDB driver
- [Chi](https://github.com/go-chi/chi) - HTTP router
- [Gin](https://github.com/gin-gonic/gin) - HTTP framework
- [Fiber](https://github.com/gofiber/fiber) - HTTP framework

## About

Gocrete was built to solve the "blank slate" problem in Go backend development. Instead of copying and pasting from previous projects or spending hours setting up infrastructure code, Gocrete provides a solid, opinionated starting point that you can customize to your needs.

The name "Gocrete" is a play on "Go" and "concrete"—providing a solid foundation for your Go projects.

---

**Built with ❤️ for the Go community**

For the latest updates, visit: https://github.com/TRiZKy/gocrete
